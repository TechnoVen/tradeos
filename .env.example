# =============================================================================
# TradeOS Environment Configuration
# =============================================================================
# Version: 2.0.0
# Last Updated: 2026-02-10
#
# TradeOS - International AI-powered algorithmic trading platform
# Originally forked from OpenAlgo (https://github.com/marketcalls/openalgo)
#
# IMPORTANT: Copy this file to .env and update all values before running.
# Generate secure keys: python -c "import secrets; print(secrets.token_hex(32))"
#
ENV_CONFIG_VERSION = '2.0.0'

# =============================================================================
# Security Configuration (REQUIRED - generate unique values!)
# =============================================================================

# TradeOS Application Key - used for Flask session signing
# Generate: python -c "import secrets; print(secrets.token_hex(32))"
APP_KEY = 'CHANGE_ME_generate_with_secrets_token_hex_32'

# Security Pepper - used for API key hashing, password hashing, token encryption
# Generate: python -c "import secrets; print(secrets.token_hex(32))"
API_KEY_PEPPER = 'CHANGE_ME_generate_with_secrets_token_hex_32'

# =============================================================================
# Broker Configuration
# =============================================================================

# Primary broker API credentials
BROKER_API_KEY = 'YOUR_BROKER_API_KEY'
BROKER_API_SECRET = 'YOUR_BROKER_API_SECRET'

# Market data API credentials (only for XTS-based brokers)
BROKER_API_KEY_MARKET = 'YOUR_BROKER_MARKET_API_KEY'
BROKER_API_SECRET_MARKET = 'YOUR_BROKER_MARKET_API_SECRET'

# OAuth redirect URL for broker authentication
REDIRECT_URL = 'http://127.0.0.1:5000/<broker>/callback'

# Enabled brokers (comma-separated list)
# International brokers: binance (Phase 1), ibkr, coinbase (Phase 2)
# Indian brokers: set ENABLE_INDIAN_BROKERS=true to enable
VALID_BROKERS = 'binance'

# Enable legacy Indian broker integrations (default: false)
# Set to true to load brokers with "region": "IN" in plugin.json
ENABLE_INDIAN_BROKERS = 'false'

# =============================================================================
# Database Configuration
# =============================================================================

# Main application database
DATABASE_URL = 'sqlite:///db/tradeos.db'

# Auxiliary databases
LATENCY_DATABASE_URL = 'sqlite:///db/latency.db'
LOGS_DATABASE_URL = 'sqlite:///db/logs.db'
SANDBOX_DATABASE_URL = 'sqlite:///db/sandbox.db'
HISTORIFY_DATABASE_URL = 'db/historify.duckdb'

# =============================================================================
# Server Configuration
# =============================================================================

# Public URL (your domain or tunnel URL)
HOST_SERVER = 'http://127.0.0.1:5000'

# Flask server settings
FLASK_HOST_IP = '127.0.0.1'
FLASK_PORT = '5000'
FLASK_DEBUG = 'False'
FLASK_ENV = 'development'

# Ngrok tunneling (for local development webhook testing)
NGROK_ALLOW = 'FALSE'

# =============================================================================
# WebSocket Configuration
# =============================================================================

WEBSOCKET_HOST = '127.0.0.1'
WEBSOCKET_PORT = '8765'
WEBSOCKET_URL = 'ws://127.0.0.1:8765'

# ZeroMQ message bus
ZMQ_HOST = '127.0.0.1'
ZMQ_PORT = '5555'

# Connection pooling
MAX_SYMBOLS_PER_WEBSOCKET = '1000'
MAX_WEBSOCKET_CONNECTIONS = '3'
ENABLE_CONNECTION_POOLING = 'true'

# =============================================================================
# Market Data APIs (International - Free Tier)
# =============================================================================
# These provide free market data for international markets.
# At least one is recommended for non-broker data access.

# Finnhub (https://finnhub.io) - Free: 60 calls/min
# Provides: US stocks, forex, crypto quotes, company fundamentals
FINNHUB_API_KEY = ''

# Alpha Vantage (https://www.alphavantage.co) - Free: 25 calls/day
# Provides: US/global stocks, forex, crypto, technical indicators
ALPHA_VANTAGE_API_KEY = ''

# CoinGecko (https://www.coingecko.com/en/api) - Free: 10-50 calls/min
# Provides: Crypto prices, market cap, volume, OHLCV
# No API key needed for free tier (rate limited by IP)

# =============================================================================
# Market Data APIs (Premium - Optional)
# =============================================================================

# Polygon.io (https://polygon.io) - Paid plans from $29/mo
# Provides: Real-time US stocks, options, forex, crypto
# POLYGON_API_KEY = ''

# =============================================================================
# AI / LLM Configuration (Optional)
# =============================================================================
# Configure one or more LLM providers for AI-powered features:
# - Strategy generation and backtesting
# - Market analysis and insights
# - Risk assessment and portfolio optimization

# OpenAI (https://platform.openai.com)
OPENAI_API_KEY = ''
OPENAI_MODEL = 'gpt-4o'

# Anthropic Claude (https://console.anthropic.com)
ANTHROPIC_API_KEY = ''
ANTHROPIC_MODEL = 'claude-sonnet-4-5-20250929'

# Google Gemini (https://aistudio.google.com)
GEMINI_API_KEY = ''
GEMINI_MODEL = 'gemini-2.0-flash'

# DeepSeek (https://platform.deepseek.com)
DEEPSEEK_API_KEY = ''
DEEPSEEK_MODEL = 'deepseek-chat'

# Ollama (local LLM - https://ollama.ai)
# No API key needed - runs locally
OLLAMA_HOST = 'http://127.0.0.1:11434'
OLLAMA_MODEL = 'llama3.1'

# Default AI provider (openai, anthropic, gemini, deepseek, ollama)
DEFAULT_AI_PROVIDER = 'openai'

# =============================================================================
# Demo Account Configuration
# =============================================================================

# Virtual capital for demo accounts (in USD)
DEMO_VIRTUAL_CAPITAL = '100000.00'

# Demo account expiry (in days) - users can renew with email
DEMO_EXPIRY_DAYS = '30'

# =============================================================================
# Logging Configuration
# =============================================================================

LOG_TO_FILE = 'False'
LOG_LEVEL = 'INFO'
LOG_DIR = 'log'
LOG_FORMAT = '[%(asctime)s] %(levelname)s in %(module)s: %(message)s'
LOG_RETENTION = '14'
LOG_COLORS = 'True'
FORCE_COLOR = '1'

# Python strategy log limits
STRATEGY_LOG_MAX_FILES = '10'
STRATEGY_LOG_MAX_SIZE_MB = '50'
STRATEGY_LOG_RETENTION_DAYS = '7'

# =============================================================================
# Rate Limiting
# =============================================================================

LOGIN_RATE_LIMIT_MIN = '5 per minute'
LOGIN_RATE_LIMIT_HOUR = '25 per hour'
RESET_RATE_LIMIT = '15 per hour'
API_RATE_LIMIT = '50 per second'
ORDER_RATE_LIMIT = '10 per second'
SMART_ORDER_RATE_LIMIT = '2 per second'
WEBHOOK_RATE_LIMIT = '100 per minute'
STRATEGY_RATE_LIMIT = '200 per minute'

# =============================================================================
# Trading Configuration
# =============================================================================

# Delay between legs in multi-legged option strategies (seconds)
SMART_ORDER_DELAY = '0.5'

# Session expiry time (24-hour format, UTC for international)
SESSION_EXPIRY_TIME = '03:00'

# Master contract cache cutoff time (24-hour format)
MASTER_CONTRACT_CUTOFF_TIME = '08:00'

# =============================================================================
# CORS Configuration
# =============================================================================

CORS_ENABLED = 'TRUE'
CORS_ALLOWED_ORIGINS = 'http://127.0.0.1:5000'
CORS_ALLOWED_METHODS = 'GET,POST,DELETE,PUT,PATCH'
CORS_ALLOWED_HEADERS = 'Content-Type,Authorization,X-Requested-With'
CORS_EXPOSED_HEADERS = ''
CORS_ALLOW_CREDENTIALS = 'FALSE'
CORS_MAX_AGE = '86400'

# =============================================================================
# Content Security Policy (CSP)
# =============================================================================

CSP_ENABLED = 'TRUE'
CSP_REPORT_ONLY = 'FALSE'
CSP_DEFAULT_SRC = "'self'"
CSP_SCRIPT_SRC = "'self' 'unsafe-inline' https://cdn.socket.io https://static.cloudflareinsights.com"
CSP_STYLE_SRC = "'self' 'unsafe-inline'"
CSP_IMG_SRC = "'self' data:"
CSP_CONNECT_SRC = "'self' wss: ws: https://cdn.socket.io"
CSP_FONT_SRC = "'self'"
CSP_OBJECT_SRC = "'none'"
CSP_MEDIA_SRC = "'self' data: https://*.amazonaws.com https://*.cloudfront.net"
CSP_FRAME_SRC = "'self'"
CSP_FORM_ACTION = "'self'"
CSP_FRAME_ANCESTORS = "'self'"
CSP_BASE_URI = "'self'"
CSP_UPGRADE_INSECURE_REQUESTS = 'FALSE'
CSP_REPORT_URI = ''

# =============================================================================
# CSRF Protection
# =============================================================================

CSRF_ENABLED = 'TRUE'
CSRF_TIME_LIMIT = ''

# Cookie names (customize for multi-instance deployments)
SESSION_COOKIE_NAME = 'session'
CSRF_COOKIE_NAME = 'csrf_token'

# =============================================================================
# Docker / Strategy Resource Configuration
# =============================================================================

# STRATEGY_MEMORY_LIMIT_MB = '1024'
# OPENBLAS_NUM_THREADS = '2'
# OMP_NUM_THREADS = '2'
# MKL_NUM_THREADS = '2'
# NUMEXPR_NUM_THREADS = '2'
# NUMBA_NUM_THREADS = '2'
# SHM_SIZE = '512m'
